<!DOCTYPE html>
<html lang="english">

<head>
            <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="google-site-verification" content="g0zsBLTsA4E4l1gZ8fQL_DlYMi4nVFIY_zMUUHCvKMI">
        <title>List Comprehensions và Generator Expressions</title>

        <!-- Bootstrap Core CSS -->
        <link href="http://cuccode.com/theme/css/bootstrap.min.css" rel="stylesheet">
        <!-- Custom CSS -->
        <!-- <link href="http://cuccode.com/theme/css/clean-blog.min.css" rel="stylesheet"> -->
        <link href="http://cuccode.com/theme/css/clean-blog.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
        <link href="http://cuccode.com/theme/css/code_blocks/monokai.css" rel="stylesheet">


        <!-- Custom Fonts -->
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->



        <meta name="description" content="Đây là 2 tính năng vô cùng mạnh mẽ và hữu dụng của Python, chúng ta sẽ cùng tìm hiểu về chúng trong bài viết sau đây.">

        <meta name="author" content="dangsonbk">

        <meta name="tags" content="python">

	        <meta property="og:locale" content="">
        <meta property="og:site_name" content="cuccode">

	<meta property="og:type" content="article">
            <meta property="article:author" content="http://cuccode.com/author/dangsonbk.html">
	<meta property="og:url" content="http://cuccode.com/list_comprehensions_and_generator_expressions.html">
	<meta property="og:title" content="List Comprehensions và Generator Expressions">
	<meta property="article:published_time" content="2017-10-24 20:45:00+07:00">
            <meta property="og:description" content="Đây là 2 tính năng vô cùng mạnh mẽ và hữu dụng của Python, chúng ta sẽ cùng tìm hiểu về chúng trong bài viết sau đây.">

            <meta property="og:image" content="http://cuccode.com//static/python/comprehensions.png">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@dangsonbk">
        <meta name="twitter:title" content="List Comprehensions và Generator Expressions">

            <meta name="twitter:image" content="http://cuccode.com//static/python/comprehensions.png">

            <meta name="twitter:description" content="Đây là 2 tính năng vô cùng mạnh mẽ và hữu dụng của Python, chúng ta sẽ cùng tìm hiểu về chúng trong bài viết sau đây.">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://cuccode.com/">cuccode</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">

                            <li><a href="http://cuccode.com/category/blockchain.html">blockchain</a></li>
                            <li class="active"><a href="http://cuccode.com/category/python.html">python</a></li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-image: url('/static/python/comprehensions.png')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>List Comprehensions và Generator Expressions</h1>
                        
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-10 col-md-10 col-md-offset-1">
    <span class="article-meta">Post by
            <a href="http://cuccode.com/author/dangsonbk.html">dangsonbk</a>
        on 24-10-2017
    </span>
    <!-- Post Content -->
    <article>
        <p>Khi học Python hoặc mò StackOverflow, sẽ không khó để bắt gặp những lệnh liên quan đến List Comprehensions và Generator Expressions như dưới đây.</p>
<div class="highlight"><pre><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>
<span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>


<p>Vừa rồi thì mình có trò chuyện với một vài bạn đang học lập trình Python và cũng đã có background về lập trình C, C++. Sau khi nói chuyện thì phát hiện ra rằng, ngay cả khi bạn đã nắm được khái niệm cơ bản về List và Generator thì cũng có thể gặp đôi chút khó khăn hoặc hiểu nhầm với Comprehensions và Expressions. Lý do thì khó mà liệt kê được hết, có thể đó là do C, C++ đã tạo một thói quen trong tư duy khiến các bạn ấy hiểu nhầm vấn đề, có bạn đã dùng rất nhiều rồi nhưng không nghĩ đó chính là Comprehension, hoặc đối với một số bạn thì 2 từ này cắt nghĩa ra tiếng Việt hơi khó và làm nhiều bạn hiểu nhầm chúng là những kiến thức nâng cao.</p>
<p><img alt="ListComp" src="static/python/ListCompAndGenExp.PNG"></p>
<p>Đúng là cũng hơi khó để cắt nghĩa 2 từ này ra tiếng Việt để hiểu được dễ dàng, mình đã thử Google Translate và được kết quả như trên. Trong bài này mình sẽ cố gắng diễn giải từ những khái niệm cơ bản nhất là List và Generator trong Python lên, lý do là tiện công chuyện giới thiệu cho các bạn mới học Python, sau đó so sánh chúng với nhau cũng như kết hợp với các ví dụ để mọi người có thể hiểu được chúng một cách rõ ràng nhất.</p>
<p>Như bất cứ bài viết nào trên blog này, nếu bạn thấy bài viết có phần nào chưa đúng hoặc thiếu sót, hãy comment cho mình bên dưới bài viết.</p>
<hr>
<h3>List trong Python (Cơ bản)</h3>
<p>TL;DR: Cũng giống như mảng trong các ngôn ngữ lập trình khác, được dùng để chứa giá trị của một chuỗi - danh sách các dữ liệu tuy nhiên, trong Python list có thể chứa được nhiều kiểu dữ liệu khác nhau.</p>
<blockquote>
<p>Kiểu dữ liệu: Ngay từ khi học tiểu học chúng ta đã được phân biệt giữa chữ và số với mục đích khác nhau, trong máy tính cũng vậy, dữ liệu sẽ được chia thành các kiểu khác nhau để dễ dàng xử lý. Tìm hiểu thêm: <a href="https://vi.wikipedia.org/wiki/Kiểu_dữ_liệu">Kiểu dữ liệu - wiki</a></p>
</blockquote>
<p>List trong Python được biểu thị bằng một tập hợp các giá trị phân cách nhau bởi dấu <code>,</code> và toàn bộ bao ngoài bằng <code>[]</code></p>
<div class="highlight"><pre><span class="n">list_1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">list_2</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">]</span>
</pre></div>


<blockquote>
<p>Mình sẽ giữ nguyên sử dụng từ <code>List</code> thay vì sử dụng từ <code>danh sách</code> hoặc <code>chuỗi, mảng</code>. Thực tế việc dịch ra đôi khi lại làm cho người học dễ nhầm lẫn giữa các kiểu dữ liệu.</p>
</blockquote>
<p>List trong Python có khả năng lưu trữ cùng lúc các kiểu dữ liệu khác nhau, hoặc thậm chí chứa một chuỗi con trong nó:</p>
<div class="highlight"><pre><span class="n">list_3</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;hi&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">list_2</span><span class="p">]</span>
</pre></div>


<p>Để đọc một giá trị trong list, ta dùng index (vị trí của phần tử):</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">list_1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_2</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_3</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&quot;hi&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">list_2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">list_3</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">list_3</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">hi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">list_3</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="go">[1, 2, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">list_3</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[&#39;c&#39;, &#39;u&#39;, &#39;c&#39;, &#39;c&#39;, &#39;o&#39;, &#39;d&#39;, &#39;e&#39;]</span>
</pre></div>


<p>Lưu ý là trong một list thì phần tử đầu tiên có giá trị index = 0; Phần tử cuối cùng có index = len(list) - 1; Với <code>len(list)</code> là độ dài (độ lớn - số phần tử) của list. Trong trường hợp <code>list_3</code>, <code>len(list_3)</code> chỉ quan tâm tới số phần tử trực tiếp của <code>list_3</code> và không quan tâm tới số phần tử của các list con hoặc kiểu dữ liệu con trong <code>list_3</code>;</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">list_3</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>


<p>Việc sửa dữ liệu trong list cũng được thực hiện bằng cách sử dụng index của phần tử:</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">list_3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">list_3</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, 1, 2, &#39;hi&#39;, [1, 2, 3], 1]</span>
</pre></div>


<p>Ngoài ra còn một số hoạt động khác có thể được thực hiện trên list bạn có thể tham khảo thêm, mặc dù chúng khá cơ bản những mình không muốn đi quá xa vào phần này nên sẽ liệt kê ra sau đây:</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Xóa phần tử</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Nối chuỗi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Nhân chuỗi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">([</span><span class="s">&#39;Hi!&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="s">&#39;Hi!&#39;</span><span class="p">,</span> <span class="s">&#39;Hi!&#39;</span><span class="p">,</span> <span class="s">&#39;Hi!&#39;</span><span class="p">,</span> <span class="s">&#39;Hi!&#39;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Kiểm tra tồn tại của phần tử trong chuỗi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">3</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">4</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">False</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Lặp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span> <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Slicing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;cuccode&#39;</span><span class="p">,</span> <span class="s">&#39;Cuccode&#39;</span><span class="p">,</span> <span class="s">&#39;CUCCODE!&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;Cuccode&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="s">&#39;Cuccode&#39;</span><span class="p">,</span> <span class="s">&#39;CUCCODE!&#39;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_a</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">list_a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Replace by slicing:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_a</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;z&#39;</span>    <span class="c">## replace [&#39;a&#39;, &#39;b&#39;] with [&#39;z&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">list_a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">]</span>
</pre></div>


<hr>
<h3>List Comprehension</h3>
<p>Bây giờ chúng ta sẽ bắt đầu với 1 trong 2 định nghĩa đang cố giải thích từ đầu. Sau khi đã được giới thiệu qua về list ở bên trên, các bạn có thể thấy cách đơn giản nhất để tạo ra list đó là định nghĩa nó:</p>
<div class="highlight"><pre><span class="n">list_a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>


<p>List Comprehension cho phép chúng ta tạo ra một list từ một kiểu dữ liệu có sẵn khác chỉ với một vòng lặp for:</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">list_a</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">list_a</span><span class="p">)</span>
<span class="go">[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]</span>
</pre></div>


<p>Đoạn code trên mình dùng để minh họa việc sử dụng List Comprehension là chính, thực tế thì bạn có thể tạo list như trên bằng cách:</p>
<div class="highlight"><pre><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>


<p>Khác biệt là bạn có thể sử dụng những điều kiện phức tạp hơn để tạo ra list mình mong muốn, ở đây mình lấy ví dụ lấy danh sách các số chia hết cho 3 trong khoảng từ 0 đến 10:</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">list_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_b</span>
<span class="go">[0, 3, 6, 9]</span>
</pre></div>


<p>Đơn giản đúng không? Hoàn toàn nhanh và dễ hiểu hơn việc bạn viết:</p>
<div class="highlight"><pre><span class="n">list_b</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">list_b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>


<p>Bây giờ chúng ta sẽ thêm một ví dụ phức tạp hơn chút:</p>
<p><strong>Tạo list bằng cách gộp 2 list:</strong></p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># http://djangostars.com/blog/list-comprehensions-and-generator-expressions/</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">letters</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">,</span> <span class="s">&#39;E&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nums_letters</span> <span class="o">=</span> <span class="p">[[</span><span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nums</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">letters</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># the comprehensions list combines two simple lists in a complex list of lists.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">nums_letters</span><span class="p">)</span>
<span class="go">[[1, &#39;A&#39;], [1, &#39;B&#39;], [1, &#39;C&#39;], [1, &#39;D&#39;], [1, &#39;E&#39;], [2, &#39;A&#39;], [2, &#39;B&#39;], [2, &#39;C&#39;], [2, &#39;D&#39;], [2, &#39;E&#39;], [3, &#39;A&#39;], [3, &#39;B&#39;], [3, &#39;C&#39;], [3, &#39;D&#39;], [3, &#39;E&#39;], [4, &#39;A&#39;], [4, &#39;B&#39;], [4, &#39;C&#39;], [4, &#39;D&#39;], [4, &#39;E&#39;], [5, &#39;A&#39;], [5, &#39;B&#39;], [5, &#39;C&#39;], [5, &#39;D&#39;], [5, &#39;E&#39;]]</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>


<p>Còn một điều nữa, đó là cái <strong>Comprehension</strong> này không chỉ giới hạn ở List, nó cũng có thể được dùng để tạo Dictionary và Set:</p>
<div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># http://djangostars.com/blog/list-comprehensions-and-generator-expressions/</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dict_comp</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span><span class="nb">chr</span><span class="p">(</span><span class="mi">65</span><span class="o">+</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">dict_comp</span><span class="p">)</span>
<span class="go">&lt;class &#39;dict&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">dict_comp</span><span class="p">)</span>
<span class="go">{1: &#39;B&#39;, 2: &#39;C&#39;, 3: &#39;D&#39;, 4: &#39;E&#39;, 5: &#39;F&#39;, 6: &#39;G&#39;, 7: &#39;H&#39;, 8: &#39;I&#39;, 9: &#39;J&#39;, 10: &#39;K&#39;}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">set_comp</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span> <span class="o">**</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">set_comp</span><span class="p">)</span>
<span class="go">&lt;class &#39;set&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">set_comp</span><span class="p">)</span>
<span class="go">{0, 8, 64, 512, 216}</span>
</pre></div>


<p>List Comprehension cho phép chúng ta tạo ra các cấu trúc dữ liệu phức tạp chỉ với những lệnh rất ngắn và tự nhiên theo phong cách Python (pythonic). Tuy nhiên có một nhược điểm đó là dữ liệu sinh ra sẽ được lưu toàn bộ vào bộ nhớ. Đối với những dữ liệu lớn, cách tốt hơn đó là sử dụng generator.</p>
<hr>
<h3>Iterate &amp; Iterable &amp; Iterator</h3>
<p>What?</p>
<p>Vâng, để hiểu về Generator Expressions, bạn cần có kiến thức về Generator, để hiểu về Generator, bạn cần phải hiểu về Iterator, và để hiểu về Iterator thì bạn cần biết Iterable, Iterate, Iteration là gì ... Đại loại thế.</p>
<p><a href="https://stackoverflow.com/a/9884259/2964364">stackoverflow.com - What exactly are Python's iterator, iterable, and iteration protocols?</a></p>
<p>Iterate có thể hiểu là hành động duyệt từng phần tử của một danh sách (sequence).</p>
<blockquote>
<p>Chú ý sequence trong Python là một kiểu giữ liệu mang tính bao quát, các kiểu dữ liệu như str (chuỗi ký tự), list, tuple đều được định nghĩa là một kiểu sequence</p>
</blockquote>
<p>Ví dụ như sau có thể hiểu là việc Iterate từng phần tử, dĩ nhiên ta bỏ qua việc để có thể thực hiện được việc này thì đều dùng đến các khái niệm iterator và iterable của <code>string</code> rồi:</p>
<div class="highlight"><pre><span class="n">string</span> <span class="o">=</span> <span class="s">&quot;abc&quot;</span>
<span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">char</span>
</pre></div>


<p><strong>Nếu một kiểu dữ liệu cho phép ta Iterate, ta hiểu nó là Iterable</strong></p>
<blockquote>
<p>Tưởng tượng việc điểm danh một lớp học bằng cách xếp hàng, người đầu hàng hô 1, người sau hô 2, cứ thế đến cuối hàng. Nếu lớp chịu xếp hàng thì mới điểm danh được, khi đó gọi lớp này là Iterable, hành động điểm danh là Iterate (động từ), danh từ cho việc này là Iteration.</p>
</blockquote>
<div class="highlight"><pre><span class="k">if</span> <span class="n">lop_hoc</span><span class="o">.</span><span class="n">co_danh_sach</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">hoc_sinh</span> <span class="ow">in</span> <span class="n">lop_hoc</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hoc_sinh</span><span class="o">.</span><span class="n">di_hoc</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Có&quot;</span>
</pre></div>


<p>Iteration là cơ sử nền tảng của việc xử lý dữ liệu trong Python. Khi làm việc trên các dữ liệu có kích thước lớn cần phải có cách thức để xử lý dữ liệu một cách nhanh gọn và đơn giản nhất. Trong Python có thể miêu tả cách thức làm việc này là <strong>fetch the items lazily</strong>. Hiểu một cách đơn giản là làm một lần và chỉ khi được yêu cầu.</p>
<p>Như ở phần trước, chúng ta có thể tạo ra một list bằng cách sử dụng comprehension, thông tin các phần tử của list này sẽ được lưu toàn bộ dưới bộ nhớ. Vấn đề gặp phải đó là nếu chúng ta cần tạo một list cực lớn, hàng triệu phần tử chẳng hạn, hoặc các phần tử trong list cũng có kích thước lớn, khi đó ta sẽ gặp vấn đề với việc tạo và quản lý list dưới bộ nhớ.</p>
<p>Dĩ nhiên list chỉ là một ví dụ minh họa cho việc cấp phát bộ nhớ để tạo dữ liệu khi chương trình hoạt động. Trên thực tế có những trường hợp chương trình sẽ phải đọc những dữ liệu có kích thước rất lớn, việc ghi và đọc toàn bộ dữ liệu vào bộ nhớ chương trình là bất khả thi hoặc tốn rất nhiều thời gian.</p>
<p><strong>Bất cứ thứ gì bạn có thể for ... in ... được thì interable.</strong></p>
<p>Có vẻ như cấu trúc <code>for ... in ...</code> của Python được thừa hưởng từ ngôn ngữ tiền nhiệm của nó: <a href="https://en.wikipedia.org/wiki/ABC_(programming_language)">ABC</a>.</p>
<div class="highlight"><pre><span class="n">FOR</span> <span class="n">word</span> <span class="n">IN</span> <span class="n">line</span><span class="o">:</span>
    <span class="k">do</span> <span class="n">something</span>
</pre></div>


<p>Cấu trúc này có thể viết lại cho dễ hiểu hơn bằng giả mã như sau:</p>
<div class="highlight"><pre><span class="n">word</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">do</span> <span class="n">something</span>
<span class="n">word</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">do</span> <span class="n">something</span>
<span class="n">word</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">do</span> <span class="n">something</span>
<span class="p">...</span>
</pre></div>


<p>cứ như vậy cho đến hết (<code>IndexError</code>)</p>
<p>Về bản chất bên trong của ngôn ngữ Python, để có thể duyệt được qua các phần tử của một đối tượng, đối tượng đó phải hỗ trợ phương thức <code>__iter__</code>. <code>__iter__</code> sẽ trả về một "iterator". Một đối tượng "iterable" có thể trả về đối tượng "iterator" khác nhau khi được duyệt khác nhau.</p>
<p>Nói về iterator, iterator được trả về khi duyệt một đối tượng iterable và được hỗ trợ (cài đặt) sẵn bên trong nó 2 phương thức: <code>__iter__</code> và <code>__next__</code>, 2 phương thức này được gọi là iteration protocol.</p>
<ul>
<li>Phương thức <code>__iter__</code> trả về chính đối tượng iterator. Để có thể sử dụng các câu lệnh <code>for</code> và <code>in</code> thì bắt buộc các đối tượng iterable và iterator phải hỗ trợ <code>__iter__</code>.</li>
<li>Phương thức <code>__next__</code> trả về phần tử tiếp theo. Nếu không còn phần tử nào nữa thì <code>StopIteration</code> <a href="cuccode.com/python_error_exceptions_handling.html">exception</a> sẽ được raise.</li>
</ul>
<p>Một hàm dựng sẵn của Python là iter nhận đầu vào là một đối tượng "iterable" và trả về kết quả là một iterator.</p>
<p>Xét một ví dụ duyệt phần tử trong một list:</p>
<div class="highlight"><pre><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mylist</span><span class="p">:</span>
    <span class="c"># do something</span>
</pre></div>


<p>Python sẽ thực hiện 2 việc sau:</p>
<ol>
<li>Lấy đối tượng iterator:</li>
</ol>
<p>Được thực hiện bằng cách gọi iter(mylist) -&gt; hàm này sẽ thực thi phương thức <code>__iter__</code> như đã nói ở trên và trả về một đối tượng mà có thể gọi <code>__next__()</code>.</p>
<ol>
<li>Dùng iterator để duyệt qua từng phần tử:</li>
</ol>
<p>Tiếp tục gọi phương thức <code>__next__()</code> trên iterator được trả về từ bước 1. Giá trị trả về khi gọi <code>__next__()</code> được trả vào biến x và thân vòng lặp <code># do something</code> được thực thi. Khi một <a href="cuccode.com/python_error_exceptions_handling.html">exception</a> <code>StopIteration</code> được sinh ra khi thực hiện <code>__next__()</code> có nghĩa là không còn phần tử nào để duyệt nữa và khi đó vòng lặp kết thúc.</p>
<hr>
<h3>Generators</h3>
<hr>
<h3>Generator Expressions</h3>
<hr>
<h3>Tham khảo:</h3>
<ul>
<li><a href="https://developers.google.com/edu/python/lists">python list - google edu</a></li>
<li><a href="https://www.tutorialspoint.com/python/python_lists.htm">list - tutorialspoint</a></li>
<li><a href="http://djangostars.com/blog/list-comprehensions-and-generator-expressions">djangostar</a></li>
<li><a href="https://infohost.nmt.edu/tcc/help/pubs/python/web/iterable.html">iterable - nmt.edu</a></li>
<li><a href="https://stackoverflow.com/questions/231767/what-does-the-yield-keyword-do">What does the “yield” keyword do? - stackoverflow</a></li>
<li><a href="https://stackoverflow.com/questions/9884132/what-exactly-are-pythons-iterator-iterable-and-iteration-protocols">What exactly are Python's iterator, iterable, and iteration protocols? - stackoverflow</a></li>
</ul>
    </article>

        <div class="tags">
            <p>tags: <a href="http://cuccode.com/tag/python.html">python</a></p>
        </div>

    <hr>
    <div class="sharing">
        <!-- AddThis Button BEGIN -->
        <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
            <a class="addthis_button_preferred_1"></a>
            <a class="addthis_button_preferred_2"></a>
            <a class="addthis_button_preferred_3"></a>
            <a class="addthis_button_preferred_4"></a>
            <a class="addthis_button_preferred_5"></a>
            <a class="addthis_button_preferred_6"></a>
            <a class="addthis_button_preferred_7"></a>
            <a class="addthis_button_preferred_8"></a>
            <a class="addthis_button_preferred_9"></a>
            <a class="addthis_button_compact"></a>
            <a class="addthis_counter addthis_bubble_style"></a>
        </div>
        <script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4e43832a47612352"></script>
        <!-- AddThis Button END -->
    </div>

        <div class="comments">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'cuccode';
                var disqus_identifier = 'list_comprehensions_and_generator_expressions.html';
                var disqus_url = 'http://cuccode.com/list_comprehensions_and_generator_expressions.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//cuccode.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                            <li>
                                <a href="https://twitter.com/dangsonbk">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/dangsonbk">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                    </ul>
<p class="copyright text-muted">
    Blog powered by <a href="http://getpelican.com">Pelican</a>,
    which takes great advantage of <a href="http://python.org">Python</a> <br />
    Theme <a href="https://github.com/dangsonbk/pelicana-clean-blog">pelicana-clean-blog</a>, a modified version of <a href="https://github.com/gilsondev/pelican-clean-blog">pelican-clean-blog</a> <br />
    &copy;  dangsonbk
</p>                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="http://cuccode.com/theme/js/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="http://cuccode.com/theme/js/bootstrap.min.js"></script>

        <!-- Custom Theme JavaScript -->
        <script src="http://cuccode.com/theme/js/clean-blog.min.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-105160643-1', 'auto');
      ga('send', 'pageview');

    </script>
<script type="text/javascript">
    var disqus_shortname = 'cuccode';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>

</html>